<!doctype html>
<html lang="ja">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>ğŸŒ· ç¬é–“è‹±ä½œæ–‡ã‚«ãƒ¼ãƒ‰</title>
<style>
  :root {
    --accent: #ff7ca8;
    --bg: #f8f8f8;
    --surface: #fff;
    --text: #333;
  }
  body {
    margin:0;
    font-family:"Noto Sans JP","Helvetica Neue",sans-serif;
    background:var(--bg);
    color:var(--text);
    display:flex;
    flex-direction:column;
    align-items:center;
    min-height:100vh;
    padding:20px;
  }
  h1 {
    color:var(--accent);
    font-size:1.2rem;
    margin-bottom:10px;
  }
  .progress {
    font-size:14px;
    color:#999;
    margin-bottom:10px;
  }

  .card {
    width:90%;
    max-width:400px;
    min-height:260px;
    background:var(--surface);
    border-radius:16px;
    box-shadow:0 4px 12px rgba(0,0,0,0.1);
    display:flex;
    flex-direction:column;
    align-items:center;
    justify-content:center;
    text-align:center;
    padding:20px;
  }

  .jp, .en {
    font-size:20px;
    margin:10px 0;
  }

  .controls {
    margin-top:15px;
    display:flex;
    justify-content:center;
    gap:10px;
    flex-wrap:wrap;
  }

  button, select {
    border:none;
    border-radius:25px;
    padding:10px 16px;
    font-size:15px;
    cursor:pointer;
    transition:0.2s;
  }
  .btn-pink { background:var(--accent); color:#fff; }
  .btn-yellow { background:#f8c24a; color:#fff; }
  .btn-blue { background:#4da7c1; color:#fff; }
  .btn-pink:hover { background:#ff6198; }

  .bottom-nav {
    display:flex;
    justify-content:space-between;
    align-items:center;
    width:90%;
    max-width:400px;
    margin-top:20px;
  }
</style>
</head>
<body>
  <h1>ğŸŒ· ç¬é–“è‹±ä½œæ–‡ã‚«ãƒ¼ãƒ‰</h1>
  <div class="progress" id="progress"></div>

  <div class="card" id="card">
    <div class="jp" id="jpText"></div>
    <div class="en" id="enText" style="display:none;"></div>
    <div class="controls" id="controls">
      <button id="flipBtn" class="btn-pink">ğŸ’¬ è§£ç­”ã‚’è¦‹ã‚‹</button>
      <button id="playAudio" class="btn-blue" style="display:none;">â–¶ å†ç”Ÿ</button>
      <select id="speedSelect" style="display:none;">
        <option value="0.8">0.8Ã—</option>
        <option value="1.0" selected>1.0Ã—</option>
        <option value="1.2">1.2Ã—</option>
      </select>
    </div>
  </div>

  <div class="bottom-nav">
    <button id="prevBtn" class="btn-yellow">â¬…</button>
    <button id="replayBtn" class="btn-pink">â†» ã‚‚ã†ä¸€åº¦</button>
    <button id="nextBtn" class="btn-blue">â¡</button>
  </div>

<script>
let cards = [];
let cur = 0;
let voices = [];
let learned = JSON.parse(localStorage.getItem('learnedCards') || '{}');

async function loadCards(){
  const res = await fetch('cards.json');
  cards = await res.json();
  showCard();
  updateProgress();
  loadVoices();
}
function updateProgress(){
  document.getElementById('progress').textContent = `${cur+1}/${cards.length}`;
}
function showCard(){
  const jp = document.getElementById('jpText');
  const en = document.getElementById('enText');
  jp.textContent = cards[cur].JP;
  en.textContent = cards[cur].ModelEN;
  jp.style.display = 'block';
  en.style.display = 'none';
  document.getElementById('flipBtn').style.display='inline-block';
  document.getElementById('playAudio').style.display='none';
  document.getElementById('speedSelect').style.display='none';
}

document.getElementById('flipBtn').onclick = ()=>{
  document.getElementById('jpText').style.display='none';
  document.getElementById('enText').style.display='block';
  document.getElementById('flipBtn').style.display='none';
  document.getElementById('playAudio').style.display='inline-block';
  document.getElementById('speedSelect').style.display='inline-block';
};

document.getElementById('nextBtn').onclick = ()=>{
  cur = (cur + 1) % cards.length;
  showCard();
  updateProgress();
};
document.getElementById('prevBtn').onclick = ()=>{
  cur = (cur - 1 + cards.length) % cards.length;
  showCard();
  updateProgress();
};

function loadVoices(){
  voices = speechSynthesis.getVoices().filter(v => v.lang.startsWith('en'));
}
speechSynthesis.onvoiceschanged = loadVoices;

function speak(text, rate=1){
  const u = new SpeechSynthesisUtterance(text);
  u.rate = rate;
  const voice = voices.find(v => v.lang.includes('US')) || voices[0];
  if(voice) u.voice = voice;
  speechSynthesis.cancel();
  speechSynthesis.speak(u);
}

document.getElementById('playAudio').onclick = ()=>{
  const rate = parseFloat(document.getElementById('speedSelect').value);
  speak(cards[cur].ModelEN, rate);
};
document.getElementById('replayBtn').onclick = ()=>{
  const rate = parseFloat(document.getElementById('speedSelect').value || 1);
  speak(cards[cur].ModelEN, rate);
};

loadCards();
</script>
</body>
</html>
