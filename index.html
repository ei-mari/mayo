<!doctype html>
<html lang="ja">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>üå∑ Áû¨ÈñìËã±‰ΩúÊñá„Ç´„Éº„Éâ</title>
<style>
body {
  font-family: "Noto Sans JP", sans-serif;
  background: #f5f7fa;
  margin: 0;
  display: flex;
  flex-direction: column;
  align-items: center;
  min-height: 100vh;
  color: #333;
}

h1 {
  font-size: 1.3rem;
  color: #26a69a;
  margin: 35px 0 10px;
}

.progress {
  color: #999;
  margin-bottom: 20px;
}

.card {
  width: 340px;
  background: #fff;
  border-radius: 20px;
  box-shadow: 0 8px 20px rgba(0,0,0,0.08);
  padding: 25px 20px;
  text-align: center;
  transition: 0.4s;
}

.jpText {
  font-size: 18px;
  color: #2c3e50;
  margin-bottom: 15px;
}

.sentence {
  font-size: 20px;
  color: #2c3e50;
  margin: 20px 0;
}

.audio-ui {
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 12px;
  margin-bottom: 20px;
}

.play-btn {
  background: #26a69a;
  border: none;
  border-radius: 50%;
  width: 50px;
  height: 50px;
  color: white;
  font-size: 22px;
  cursor: pointer;
  box-shadow: 0 4px 10px rgba(0,0,0,0.1);
}

.play-btn:hover {
  background: #2bbbad;
}

.progress-bar {
  flex-grow: 1;
  height: 6px;
  background: #e0e0e0;
  border-radius: 3px;
  position: relative;
}

.progress-fill {
  position: absolute;
  height: 6px;
  left: 0;
  top: 0;
  width: 0;
  background: #26a69a;
  border-radius: 3px;
  transition: width 0.3s;
}

.speed-select {
  border: none;
  background: #f5f5f5;
  border-radius: 6px;
  padding: 4px 6px;
  font-size: 13px;
  color: #333;
}

.memory-buttons {
  display: flex;
  justify-content: center;
  gap: 10px;
  margin-bottom: 10px;
}

button {
  border: none;
  border-radius: 25px;
  padding: 10px 14px;
  font-size: 14px;
  cursor: pointer;
  transition: 0.2s;
  box-shadow: 0 3px 6px rgba(0,0,0,0.1);
}

.btn-pink { background: #ef5350; color: #fff; }
.btn-blue { background: #42a5f5; color: #fff; }
.btn-yellow { background: #fbc02d; color: #fff; }

.btn-pink:hover { background: #e53935; }
.btn-blue:hover { background: #1e88e5; }

.bottom-nav {
  margin-top: 30px;
  display: flex;
  justify-content: center;
  gap: 15px;
}
</style>
</head>
<body>

<h1>üå∑ Áû¨ÈñìËã±‰ΩúÊñá„Ç´„Éº„Éâ</h1>
<div class="progress" id="progress">Loading...</div>

<div class="card" id="card">
  <div class="jpText" id="jpText"></div>
  <div class="sentence" id="enText"></div>

  <div class="audio-ui">
    <button id="playBtn" class="play-btn">‚ñ∂</button>
    <div class="progress-bar"><div id="fill" class="progress-fill"></div></div>
    <select id="speedSelect" class="speed-select">
      <option value="0.8">0.8√ó</option>
      <option value="1.0" selected>1.0√ó</option>
      <option value="1.2">1.2√ó</option>
    </select>
  </div>

  <div class="memory-buttons">
    <button id="rememberBtn" class="btn-blue">Ë¶ö„Åà„ÅüÔºÅ</button>
    <button id="notRememberBtn" class="btn-pink">„Åæ„Å†Ë¶ö„Åà„Å¶„ÅÑ„Å™„ÅÑ</button>
  </div>
</div>

<div class="bottom-nav">
  <button id="prevBtn" class="btn-yellow">‚¨Ö</button>
  <button id="replayBtn" class="btn-pink">‚Üª „ÇÇ„ÅÜ‰∏ÄÂ∫¶</button>
  <button id="nextBtn" class="btn-blue">‚û°</button>
</div>

<script>
const jpText = document.getElementById('jpText');
const enText = document.getElementById('enText');
const playBtn = document.getElementById('playBtn');
const fill = document.getElementById('fill');
const speedSelect = document.getElementById('speedSelect');
const rememberBtn = document.getElementById('rememberBtn');
const notRememberBtn = document.getElementById('notRememberBtn');
const progress = document.getElementById('progress');

let cards = [];
let cur = 0;
let utter;
let learnedStatus = {};

// JSON Ë™≠„ÅøËæº„Åø
async function loadCards() {
  try {
    const res = await fetch('cards.json');
    cards = await res.json();
    updateCard();
  } catch {
    progress.textContent = '„Ç´„Éº„Éâ„Éá„Éº„Çø„ÇíË™≠„ÅøËæº„ÇÅ„Åæ„Åõ„Çì„Åß„Åó„Åü„ÄÇ';
  }
}

function updateCard() {
  if (!cards.length) return;
  const item = cards[cur];
  jpText.textContent = item.JP;
  enText.textContent = item.ModelEN;
  progress.textContent = `${cur + 1}/${cards.length}`;
  fill.style.width = "0%";
}

// Èü≥Â£∞ÂÜçÁîü
function playAudio() {
  if (speechSynthesis.speaking) {
    speechSynthesis.cancel();
    fill.style.width = "0%";
    return;
  }
  const rate = parseFloat(speedSelect.value);
  utter = new SpeechSynthesisUtterance(cards[cur].ModelEN);
  utter.lang = 'en-US';
  utter.rate = rate;
  utter.onstart = () => {
    fill.style.width = "0%";
    fill.animate([{ width: "0%" }, { width: "100%" }], { duration: 1500 / rate, fill: "forwards" });
  };
  utter.onend = () => fill.style.width = "100%";
  speechSynthesis.speak(utter);
}

playBtn.onclick = playAudio;
document.getElementById('replayBtn').onclick = playAudio;

// Ë¶ö„Åà„Åü / Ë¶ö„Åà„Å¶„Å™„ÅÑ
rememberBtn.onclick = notRememberBtn.onclick = () => {
  learnedStatus[cur] = (event.target.id === "rememberBtn");
  localStorage.setItem('learnedStatus', JSON.stringify(learnedStatus));
  nextCard();
};

function nextCard() {
  cur = (cur + 1) % cards.length;
  updateCard();
}

document.getElementById('nextBtn').onclick = nextCard;
document.getElementById('prevBtn').onclick = () => {
  cur = (cur - 1 + cards.length) % cards.length;
  updateCard();
};

loadCards();
</script>
</body>
</html>
